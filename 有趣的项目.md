# EasyExcel

## 导入

### 快速入门

- 引入依赖

  ```xml
  <dependency>
      <groupId>com.alibaba</groupId>
      <artifactId>easyexcel</artifactId>
      <version>3.1.4</version>
  </dependency>
  ```

- Excel 表格

  | id   | 姓名 | 性别 | 生日          |
  | ---- | ---- | ---- | ------------- |
  | 1    | 张三 | 男   | 2002年3月12日 |

- 读取 Excel 文件

  ```java
  File file  = new File("C:\\Users\\yoga\\Desktop\\test.xlsx");
  List<Map<Integer, Object>> list = EasyExcel
      .read(file)
      .sheet() // 指定工作表。可填参数：表名(sheet1)、索引(0)、空参(第一张表)
      .doReadSync();
  
  // 默认Excel的第一行为表头行，从第二行开始是数据行
  // 所以数据从第二行开始存储到 List<Map<Integer, Object>> 中
  Map<Integer, Object> map = list.get(0);
  System.out.println(map); // {1=1, 2=张三, 3=男, 4=2002年3月12日}
  ```



### 模型映射

- 关系映射
  - `@ExcelProperty`：默认属性在映射类中的次序 与 map的key值对应
  - `@ExcelProperty(value = "列名")`：指定对应列名
  - `@ExcelProperty(index = 0)`：指定对应key值

- 自定义解析

  - `@ExcelProperty(converter = 自定义格式转换.class)`

- 使用

  ```java
  List<映射模型类> list = EasyExcel
      .read(file)
      .head(映射模型.class) // 指定映射模型
      .sheet()
      .doReadSync();
  ```

  ```java
  @Data
  @ToString
  public class Person {
      @ExcelProperty("id")
      private int id;
  
      @ExcelProperty("姓名")
      private String name;
  
      @ExcelProperty("性别")
      private String gender;
  
      @ExcelProperty(value = "生日", converter = LocalDateConverter.class)
      private LocalDate birthday;
  }
  ```

  ```java
  public class LocalDateConverter implements Converter<LocalDate> {
      @Override
      public LocalDate convertToJavaData(ReadCellData cellData, ExcelContentProperty contentProperty, GlobalConfiguration globalConfiguration) throws Exception {
  
          String stringValue = cellData.getStringValue();
          return LocalDate.parse(stringValue, DateTimeFormatter.ofPattern("yyyy年MM月dd日"));
      }
  }
  ```

  



